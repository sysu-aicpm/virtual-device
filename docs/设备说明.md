# 设备说明文档

## 通用特性

所有设备都具有以下基本特性：

1. 设备标识
   - `device_id`：全局唯一的设备标识符（UUID格式）
   - `device_type`：设备类型标识

2. 基本状态
   - `power`：当前功耗（单位：瓦特）
   - `status`：设备状态
   - `last_update`：最后更新时间

3. 通用功能
   - 心跳包发送（默认每5秒）
   - 状态查询
   - 事件通知
   - 自动事件生成

## 具体设备说明

### 1. 冰箱（Refrigerator）

**基本信息**
- 设备类型：`refrigerator`
- 默认功耗：100W
- 默认温度：4℃

**特有属性**
- `temperature`：冰箱温度（范围：-20℃ ~ 10℃）
- `door_open`：冰箱门状态（true/false）

**自动行为**
- 每5-15秒有30%概率随机开关冰箱门
- 开门时发送 door_state_change 事件
- 温度保持在设定值不变

**控制命令**
- `set_temperature`：设置冰箱温度
  - 参数：temperature（整数，范围：-20 ~ 10）
  - 示例：设置温度为2℃

### 2. 智能灯（Light）

**基本信息**
- 设备类型：`light`
- 默认功耗：10W（最大）
- 默认状态：关闭（brightness = 0）

**特有属性**
- `brightness`：亮度（范围：0-100）
- 功耗随亮度变化：功耗 = 亮度 / 10（瓦特）

**自动行为**
- 每5-15秒有20%概率随机调节亮度
- 亮度改变时自动调整功耗
- 亮度变化时发送 state_change 事件

**控制命令**
1. `set_brightness`：调节亮度
   - 参数：brightness（整数，范围：0-100）
   - 影响：改变亮度和功耗
2. `switch`：开关控制
   - 参数：state（"on"/"off"）
   - 影响：开启时亮度100，关闭时亮度0

### 3. 智能门锁（Lock）

**基本信息**
- 设备类型：`lock`
- 默认功耗：5W
- 默认状态：锁定

**特有属性**
- `locked`：锁定状态（true/false）
- `status`：显示为"locked"或"unlocked"

**自动行为**
- 每5-15秒有15%概率随机切换锁定状态
- 状态改变时发送 lock_state_change 事件
- 功耗保持恒定

**控制命令**
- `set_lock`：设置锁定状态
  - 参数：state（"lock"/"unlock"）
  - 影响：改变锁定状态和显示状态

### 4. 智能摄像头（Camera）

**基本信息**
- 设备类型：`camera`
- 默认功耗：15W（待机）/25W（录制）
- 默认分辨率：1080p

**特有属性**
- `recording`：录制状态（true/false）
- `resolution`：分辨率（720p/1080p/4k）
- `status`：显示为"recording"或"standby"

**自动行为**
- 每5-15秒有25%概率随机开始/停止录制
- 每5-15秒有10%概率随机切换分辨率
- 录制状态改变时自动调整功耗
- 状态改变时发送 recording_state_change 事件

**控制命令**
1. `set_recording`：控制录制
   - 参数：state（"start"/"stop"）
   - 影响：改变录制状态和功耗
2. `set_resolution`：设置分辨率
   - 参数：resolution（"720p"/"1080p"/"4k"）
   - 影响：改变视频质量

## 事件说明

每个设备在状态发生变化时，都会向控制器发送事件通知。事件包含以下信息：
- 设备标识（device_id）
- 设备类型（device_type）
- 事件类型（event_type）
- 事件数据（event_data）
- 时间戳（timestamp）

### 事件类型说明

1. 冰箱事件
   - `door_state_change`：门状态改变
   ```json
   {
       "door_open": true/false
   }
   ```

2. 灯事件
   - `state_change`：状态改变
   ```json
   {
       "status": "on"/"off",
       "brightness": 0-100
   }
   ```

3. 门锁事件
   - `lock_state_change`：锁定状态改变
   ```json
   {
       "locked": true/false
   }
   ```

4. 摄像头事件
   - `recording_state_change`：录制状态改变
   ```json
   {
       "recording": true/false,
       "resolution": "720p"/"1080p"/"4k"
   }
   ```

## 配置说明

设备的配置通过环境变量或 `.env` 文件进行设置：

```ini
HOST=0.0.0.0              # 服务器监听地址
PORT=5000                 # 服务器端口
CONTROLLER_URL=http://localhost:8000  # 控制器地址
HEARTBEAT_INTERVAL=5      # 心跳间隔（秒）
DEVICE_TYPE=refrigerator  # 设备类型
``` 